!function(e){const s=require("./components/modelerBuilder.js");module.exports=class{constructor(){this._config=null}init(e){if(this._config=e,!this._validate())return!1;const s=this._createModelers();return new Promise(e=>e(s))}_validate(){let e=!0;if(this._config instanceof Object||this._config instanceof Array?this._config instanceof Array&&!this._config.length&&(console.error("Neysla: Array of initializators is empty."),e=!1):(console.error("Neysla: You must set an Array or an Object to initializate your modelers."),e=!1),!e||this._config instanceof Array||(this._config=[this._config]),e)for(let s in this._config)this._config.hasOwnProperty(s)&&(this._config[s].name&&"string"==typeof this._config[s].name?"string"!=typeof this._config[s].url?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined url.`),e=!1):this._config[s].headers&&("object"!=typeof this._config[s].headers||this._config[s].headers instanceof Array)?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined headers.`),e=!1):this._config[s].params&&("object"!=typeof this._config[s].params||this._config[s].params instanceof Array)?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined params.`),e=!1):this._config[s].requestType&&"string"!=typeof this._config[s].requestType?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined requestType.`),e=!1):this._config[s].responseType&&"string"!=typeof this._config[s].responseType?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined responseType.`),e=!1):this._config[s].body&&("object"!=typeof this._config[s].body||this._config[s].body instanceof Array)&&(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined body.`),e=!1):(console.error(`Neysla: Initializator with index ${s} has no properly defined name.`),e=!1));return e}_createModelers(){const e={};for(const t of this._config)e[t.name]=new s(t);return e}static get(e={}){return this._setRequest(e,"GET")}static head(e={}){return this._setRequest(e,"HEAD")}static post(e={}){return this._setRequest(e,"POST",!0)}static patch(e={}){return this._setRequest(e,"PATCH",!0)}static put(e={}){return this._setRequest(e,"PUT",!0)}static remove(e={}){return this._setRequest(e,"DELETE",!0)}static _setRequest(e,s,t=!1){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;const r=t?this._setBody(e.body,e.requestType):null,n=this._setRequestType(e.requestType),o=e.responseType&&"string"==typeof e.responseType?e.responseType:"json";return e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){}),this._executeRequest({method:s,body:r,requestType:n,responseType:o,headers:e.headers,progress:e.progress,url:e.url})}static _setBody(e,s){let t=null;if(e instanceof Object)switch(s){case"json":t=JSON.stringify(e);break;case"multipart":t=new FormData,Object.keys(e).forEach(s=>t.append(s,e[s]));break;default:t="",Object.keys(e).forEach(s=>t+=`${""!==t?"&":""}${s}=${e[s]}`)}return t}static _setRequestType(e){let s;switch(e){case"json":s="application/json";break;case"multipart":s=null;break;default:s="application/x-www-form-urlencoded"}return s}static _executeRequest(e){return e.url&&"string"==typeof e.url?new Promise((s,t)=>{const r=new XMLHttpRequest;r.addEventListener("progress",e.progress),r.addEventListener("abort",()=>this._handleResponse(r,s,t,e.url,e.responseType,!0)),r.addEventListener("error",()=>this._handleResponse(r,s,t,e.url,e.responseType,!0)),r.addEventListener("load",()=>this._handleResponse(r,s,t,e.url,e.responseType)),r.open(e.method,e.url,!0),r.responseType=e.responseType,e.requestType&&r.setRequestHeader("Content-Type",e.requestType),Object.keys(e.headers).forEach(s=>{r.setRequestHeader(s,e.headers[s])}),r.send(e.body)}):(console.error("Neysla: Request has no properly defined url."),!1)}static _handleResponse(e,s,t,r,n,o=!1){const i={headers:{},status:e.status,statusText:e.statusText,getHeader:s=>e.getResponseHeader(s),data:o||"json"!==n||"string"!=typeof e.response?e.response:JSON.parse(e.response),dataType:e.responseType,url:r},a=e.getAllResponseHeaders().split("\r\n");for(const e of a)if(""!==e){const s=e.split(":");i.headers[s[0]]=s[1].trim()}e.status>=300||0===e.status||o?t(i):s(i)}}}("undefined"==typeof Neysla?Neysla={}:Neysla);