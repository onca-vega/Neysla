!function(e){class s{constructor(e){this.config=e}getToken(){return this.config.token}setModel(e){return e instanceof Array||"string"==typeof e?new t(this.config,e):(console.error("Neysla: The model's name is not properly defined."),!1)}}class t{constructor(e,s){this.token=e.token,this.name=s,this.url=e.url}_setUrl(e){if(!(e instanceof Object))return console.error("Neysla: The model's configuration must be an object."),!1;if(e.delimiters&&!(e.delimiters instanceof Array||"string"==typeof e.delimiters||"number"==typeof e.delimiters))return console.error("Neysla: The model's delimiters are not properly defined."),!1;if(!e.delimiters||e.delimiters instanceof Array?e.delimiters||(e.delimiters=[]):e.delimiters=[e.delimiters],"string"==typeof this.name&&(this.name=[this.name]),this.name.length!==e.delimiters.length&&this.name.length-1!==e.delimiters.length)return console.error("Neysla: Incorrect relation between name and delimiters."),!1;let s="";for(let t in this.name)s+=`${this.name[t]}${e.delimiters[t]?"/"+e.delimiters[t]:""}${parseInt(t,10)===this.name.length-1?this.token?`?${this.token.name}=${this.token.value}`:"":"/"}`;return s}_setParams(e){let s="";if(e instanceof Object){let t=0;Object.keys(e).forEach(r=>{s+=`${0!==t||0===t&&this.token?"&":"?"}${r}=${e[r]}`,t++})}return s}_executeRequest(e){return new Promise((s,t)=>{const r=new XMLHttpRequest;r.addEventListener("progress",e.progress),r.addEventListener("abort",()=>this._handleResponse(r,s,t,e.url,!0)),r.addEventListener("error",()=>this._handleResponse(r,s,t,e.url,!0)),r.addEventListener("load",()=>this._handleResponse(r,s,t,e.url)),r.responseType=e.responseType&&"string"==typeof e.responseType?e.responseType:"json",r.open(e.method,e.url,!0),e.requestType&&r.setRequestHeader("Content-Type",e.requestType);for(let s in e.headers)e.headers.hasOwnProperty(s)&&r.setRequestHeader(s,e.headers[s]);r.send(e.body)})}_handleResponse(e,s,t,r,n=!1){const o={headers:{},status:e.status,statusText:e.statusText,getHeader:s=>e.getResponseHeader(s),data:e.response,dataType:e.responseType,url:r};let a=e.getAllResponseHeaders().split("\r\n");for(const e of a)if(""!==e){const s=e.split(":");o.headers[s[0]]=s[1].trim()}e.status>=300||0===e.status||n?t(o):s(o)}_setBody(e,s){let t=null;if(e instanceof Object)switch(s){case"json":t=JSON.stringify(e);break;case"multipart":t=new FormData,Object.keys(e).forEach(s=>t.append(s,e[s]));break;default:t="",Object.keys(e).forEach(s=>t+=`${""!==t?"&":""}${s}=${e[s]}`)}return t}_handleRequest(e){let s;switch(e){case"json":s="application/json";break;case"multipart":s=null;break;default:s="application/x-www-form-urlencoded"}return s}get(e={}){let s=this._setUrl(e);if(!1===s)return s;e.params instanceof Object&&(s+=this._setParams(e.params)),e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const t=this._handleRequest(e.requestType);return this._executeRequest({method:"GET",url:this.url+s,headers:e.headers,requestType:t,responseType:e.responseType,progress:e.progress,body:null})}head(e={}){let s=this._setUrl(e);if(!1===s)return s;e.params instanceof Object&&(s+=this._setParams(e.params)),e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const t=this._handleRequest(e.requestType);return this._executeRequest({method:"HEAD",url:this.url+s,headers:e.headers,requestType:t,responseType:e.responseType,progress:e.progress,body:null})}post(e={}){let s=this._setUrl(e);if(!1===s)return s;e.params instanceof Object&&(s+=this._setParams(e.params)),e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const t=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"POST",url:this.url+s,headers:e.headers,requestType:r,responseType:e.responseType,progress:e.progress,body:t})}patch(e={}){let s=this._setUrl(e);if(!1===s)return s;e.params instanceof Object&&(s+=this._setParams(e.params)),e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const t=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"PATCH",url:this.url+s,headers:e.headers,requestType:r,responseType:e.responseType,progress:e.progress,body:t})}put(e={}){let s=this._setUrl(e);if(!1===s)return s;e.params instanceof Object&&(s+=this._setParams(e.params)),e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const t=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"PUT",url:this.url+s,headers:e.headers,requestType:r,responseType:e.responseType,progress:e.progress,body:t})}remove(e={}){let s=this._setUrl(e);if(!1===s)return s;e.params instanceof Object&&(s+=this._setParams(e.params)),e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const t=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"DELETE",url:this.url+s,headers:e.headers,requestType:r,responseType:e.responseType,progress:e.progress,body:t})}}module.exports=class{constructor(){this.config=null}init(e){if(this.config=this._doError(e),!this.config)return!1;const s=this._doService(this.config);return new Promise(e=>e(s))}_doError(e){let s=!0;if(e instanceof Object||e instanceof Array?e instanceof Array&&!e.length&&(console.error("Neysla: Array of initializators is empty."),s=!1):(console.error("Neysla: You must set an Array or an Object to initializate your modelers."),s=!1),!s||e instanceof Array||(e=[e]),s)for(let t in e)e.hasOwnProperty(t)&&(e[t].name&&"string"==typeof e[t].name&&""!=typeof e[t].name?e[t].url&&"string"==typeof e[t].url&&""!=typeof e[t].url?e[t].token&&"object"==typeof e[t].token&&!("object"==typeof e[t].token&&e[t].token instanceof Array)&&e[t].token.name&&"string"==typeof e[t].token.name&&""!=typeof e[t].token.name&&e[t].token.value&&"string"==typeof e[t].token.value&&""!=typeof e[t].token.value||(console.warn(`Neysla: Initializator with index ${t} has no properly defined token's name and/or value. Therefore no token will be added to your models`),e[t].token=null):(console.error(`Neysla: Initializator with index ${t} has no properly defined url.`),s=!1):(console.error(`Neysla: Initializator with index ${t} has no properly defined name.`),s=!1));return!!s&&e}_doService(e){const s={};for(const t of e)s[t.name]=this._setBuilder(t);return s}_setBuilder(e){return new s({url:e.url,token:e.token})}static _executeRequest(e){return e.url&&"string"==typeof e.url?new Promise((s,t)=>{const r=new XMLHttpRequest;r.addEventListener("progress",e.progress),r.addEventListener("abort",()=>this._handleResponse(r,s,t,e.url,!0)),r.addEventListener("error",()=>this._handleResponse(r,s,t,e.url,!0)),r.addEventListener("load",()=>this._handleResponse(r,s,t,e.url)),r.responseType=e.responseType&&"string"==typeof e.responseType?e.responseType:"json",r.open(e.method,e.url,!0),e.requestType&&r.setRequestHeader("Content-Type",e.requestType);for(let s in e.headers)e.headers.hasOwnProperty(s)&&r.setRequestHeader(s,e.headers[s]);r.send(e.body)}):(console.error("Neysla: Request has no properly defined url."),!1)}static _handleResponse(e,s,t,r,n=!1){const o={headers:{},status:e.status,statusText:e.statusText,getHeader:s=>e.getResponseHeader(s),data:e.response,dataType:e.responseType,url:r};let a=e.getAllResponseHeaders().split("\r\n");for(const e of a)if(""!==e){const s=e.split(":");o.headers[s[0]]=s[1].trim()}e.status>=300||0===e.status||n?t(o):s(o)}static _setBody(e,s){let t=null;if(e instanceof Object)switch(s){case"json":t=JSON.stringify(e);break;case"multipart":t=new FormData,Object.keys(e).forEach(s=>t.append(s,e[s]));break;default:t="",Object.keys(e).forEach(s=>t+=`${""!==t?"&":""}${s}=${e[s]}`)}return t}static _handleRequest(e){let s;switch(e){case"json":s="application/json";break;case"multipart":s=null;break;default:s="application/x-www-form-urlencoded"}return s}static get(e={}){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const s=this._handleRequest(e.requestType);return this._executeRequest({method:"GET",url:e.url,headers:e.headers,requestType:s,responseType:e.responseType,progress:e.progress,body:null})}static head(e={}){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const s=this._handleRequest(e.requestType);return this._executeRequest({method:"HEAD",url:e.url,headers:e.headers,requestType:s,responseType:e.responseType,progress:e.progress,body:null})}static post(e={}){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),t=this._handleRequest(e.requestType);return this._executeRequest({method:"POST",url:e.url,headers:e.headers,requestType:t,responseType:e.responseType,progress:e.progress,body:s})}static patch(e={}){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),t=this._handleRequest(e.requestType);return this._executeRequest({method:"PATCH",url:e.url,headers:e.headers,requestType:t,responseType:e.responseType,progress:e.progress,body:s})}static put(e={}){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),t=this._handleRequest(e.requestType);return this._executeRequest({method:"PUT",url:e.url,headers:e.headers,requestType:t,responseType:e.responseType,progress:e.progress,body:s})}static remove(e={}){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),t=this._handleRequest(e.requestType);return this._executeRequest({method:"DELETE",url:e.url,headers:e.headers,requestType:t,responseType:e.responseType,progress:e.progress,body:s})}}}("undefined"==typeof Neysla?Neysla={}:Neysla);