!function(e){class s{constructor(e){this.config=e}setModel(e){return e instanceof Array||"string"==typeof e?new t(this.config,e):(console.error(`Neysla: A model's name of ${this.config.name} modeler is not properly defined.`),!1)}}class t{constructor(e,s){this._modelerName=e.name,this._url=e.url,this._params=e.params instanceof Object&&Object.keys(e.params).length?e.params:null,this._headers=e.headers instanceof Object&&Object.keys(e.headers).length?e.headers:null,this._requestType=e.requestType&&"string"==typeof e.requestType?e.requestType:null,this._responseType=e.responseType&&"string"==typeof e.responseType?e.responseType:null,this._body=e.body instanceof Object&&Object.keys(e.body).length?e.body:null,this._name=s}get(e={}){return this._setRequest(e,"GET")}head(e={}){return this._setRequest(e,"HEAD")}post(e={}){return this._setRequest(e,"POST",!0)}patch(e={}){return this._setRequest(e,"PATCH",!0)}put(e={}){return this._setRequest(e,"PUT",!0)}remove(e={}){return this._setRequest(e,"DELETE",!0)}_setRequest(e,s,t=!1){if(!(e instanceof Object))return console.error("Neysla: The model's configuration must be an object."),!1;if(e.delimiters&&!(e.delimiters instanceof Array||"string"==typeof e.delimiters||"number"==typeof e.delimiters))return console.error("Neysla: The model's delimiters are not properly defined."),!1;let r=this._setUrl(e.delimiters);if(!1===r)return r;r+=this._setParams(e.params);const n=this._setHeaders(e.headers),o=t?this._setBody(e.body,e.requestType||this._requestType):null,i=this._setRequestType(e.requestType),a="string"==typeof e.responseType?e.responseType:"string"==typeof this._responseType?this._responseType:"json";return e.progress instanceof Function||(e.progress=function(){}),this._executeRequest({method:s,url:r,headers:n,body:o,requestType:i,responseType:a,progress:e.progress})}_setUrl(e){if(!e||e instanceof Array?e||(e=[]):e=[e],"string"==typeof this._name&&(this._name=[this._name]),this._name.length!==e.length&&this._name.length-1!==e.length)return console.error("Neysla: Incorrect relation between name and delimiters."),!1;let s="";for(let t in this._name)s+=`${this._name[t]}${e[t]?"/"+e[t]:""}${parseInt(t,10)===this._name.length-1?"":"/"}`;return this._url+s}_setParams(e){let s="",t=null;return this._params instanceof Object&&(t={...this._params}),e instanceof Object&&(t={...t,...e}),t instanceof Object&&Object.keys(t).forEach((e,r)=>{s+=`${0!==r?"&":"?"}${e}=${t[e]}`}),s}_setHeaders(e){let s={};return this._headers instanceof Object&&(s={...this._headers}),e instanceof Object&&(s={...s,...e}),s}_setRequestType(e=this._requestType){let s;switch(e){case"json":s="application/json";break;case"multipart":s=null;break;default:s="application/x-www-form-urlencoded"}return s}_setBody(e,s){let t=null,r=null;if(this._body instanceof Object&&(r={...this._body}),e instanceof Object&&(r={...r,...e}),r instanceof Object)switch(s){case"json":t=JSON.stringify(r);break;case"multipart":t=new FormData,Object.keys(r).forEach(e=>t.append(e,r[e]));break;default:t="",Object.keys(r).forEach(e=>t+=`${""!==t?"&":""}${e}=${r[e]}`)}return t}_executeRequest(e){return new Promise((s,t)=>{const r=new XMLHttpRequest;r.addEventListener("progress",e.progress),r.addEventListener("abort",()=>this._handleResponse(r,s,t,e.url,e.responseType,!0)),r.addEventListener("error",()=>this._handleResponse(r,s,t,e.url,e.responseType,!0)),r.addEventListener("load",()=>this._handleResponse(r,s,t,e.url,e.responseType)),r.open(e.method,e.url,!0),r.responseType=e.responseType,e.requestType&&r.setRequestHeader("Content-Type",e.requestType);for(let s in e.headers)e.headers.hasOwnProperty(s)&&r.setRequestHeader(s,e.headers[s]);r.send(e.body)})}_handleResponse(e,s,t,r,n,o=!1){const i={headers:{},status:e.status,statusText:e.statusText,getHeader:s=>e.getResponseHeader(s),data:o||"json"!==n||"string"!=typeof e.response?e.response:JSON.parse(e.response),dataType:e.responseType,url:r};let a=e.getAllResponseHeaders().split("\r\n");for(const e of a)if(""!==e){const s=e.split(":");i.headers[s[0]]=s[1].trim()}e.status>=300||0===e.status||o?t(i):s(i)}}module.exports=class{constructor(){this._config=null}init(e){if(this._config=e,!this._validate())return!1;const s=this._createModelers();return new Promise(e=>e(s))}_validate(){let e=!0;if(this._config instanceof Object||this._config instanceof Array?this._config instanceof Array&&!this._config.length&&(console.error("Neysla: Array of initializators is empty."),e=!1):(console.error("Neysla: You must set an Array or an Object to initializate your modelers."),e=!1),!e||this._config instanceof Array||(this._config=[this._config]),e)for(let s in this._config)this._config.hasOwnProperty(s)&&(this._config[s].name&&"string"==typeof this._config[s].name?"string"!=typeof this._config[s].url?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined url.`),e=!1):this._config[s].headers&&("object"!=typeof this._config[s].headers||this._config[s].headers instanceof Array)?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined headers.`),e=!1):this._config[s].params&&("object"!=typeof this._config[s].params||this._config[s].params instanceof Array)?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined params.`),e=!1):this._config[s].requestType&&"string"!=typeof this._config[s].requestType?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined requestType.`),e=!1):this._config[s].responseType&&"string"!=typeof this._config[s].responseType?(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined responseType.`),e=!1):this._config[s].body&&("object"!=typeof this._config[s].body||this._config[s].body instanceof Array)&&(console.error(`Neysla: Initializator with name ${this._config[s].name} has no properly defined body.`),e=!1):(console.error(`Neysla: Initializator with index ${s} has no properly defined name.`),e=!1));return e}_createModelers(){const e={};for(const t of this._config)e[t.name]=new s(t);return e}static get(e={}){return this._setRequest(e,"GET")}static head(e={}){return this._setRequest(e,"HEAD")}static post(e={}){return this._setRequest(e,"POST",!0)}static patch(e={}){return this._setRequest(e,"PATCH",!0)}static put(e={}){return this._setRequest(e,"PUT",!0)}static remove(e={}){return this._setRequest(e,"DELETE",!0)}static _setRequest(e,s,t=!1){if(!(e instanceof Object))return console.error("Neysla: The configuration must be an object."),!1;const r=t?this._setBody(e.body,e.requestType):null,n=this._setRequestType(e.requestType),o=e.responseType&&"string"==typeof e.responseType?e.responseType:"json";return e.headers instanceof Object||(e.headers={}),e.progress instanceof Function||(e.progress=function(){}),this._executeRequest({method:s,body:r,requestType:n,responseType:o,headers:e.headers,progress:e.progress,url:e.url})}static _setBody(e,s){let t=null;if(e instanceof Object)switch(s){case"json":t=JSON.stringify(e);break;case"multipart":t=new FormData,Object.keys(e).forEach(s=>t.append(s,e[s]));break;default:t="",Object.keys(e).forEach(s=>t+=`${""!==t?"&":""}${s}=${e[s]}`)}return t}static _setRequestType(e){let s;switch(e){case"json":s="application/json";break;case"multipart":s=null;break;default:s="application/x-www-form-urlencoded"}return s}static _executeRequest(e){return e.url&&"string"==typeof e.url?new Promise((s,t)=>{const r=new XMLHttpRequest;r.addEventListener("progress",e.progress),r.addEventListener("abort",()=>this._handleResponse(r,s,t,e.url,e.responseType,!0)),r.addEventListener("error",()=>this._handleResponse(r,s,t,e.url,e.responseType,!0)),r.addEventListener("load",()=>this._handleResponse(r,s,t,e.url,e.responseType)),r.open(e.method,e.url,!0),r.responseType=e.responseType,e.requestType&&r.setRequestHeader("Content-Type",e.requestType),Object.keys(e.headers).forEach(s=>{r.setRequestHeader(s,e.headers[s])}),r.send(e.body)}):(console.error("Neysla: Request has no properly defined url."),!1)}static _handleResponse(e,s,t,r,n,o=!1){const i={headers:{},status:e.status,statusText:e.statusText,getHeader:s=>e.getResponseHeader(s),data:o||"json"!==n||"string"!=typeof e.response?e.response:JSON.parse(e.response),dataType:e.responseType,url:r},a=e.getAllResponseHeaders().split("\r\n");for(const e of a)if(""!==e){const s=e.split(":");i.headers[s[0]]=s[1].trim()}e.status>=300||0===e.status||o?t(i):s(i)}}}("undefined"==typeof Neysla?Neysla={}:Neysla);