!function(e){class t{constructor(e){this.config=e}getToken(){return this.config.token}setModel(e){return e instanceof Array||"string"==typeof e?new s(this.config,e):(console.error("Neysla: The model's name is not properly defined."),!1)}}class s{constructor(e,t){this.token=e.token,this.name=t,this.url=e.url}_setUrl(e){if(!(e instanceof Object))return console.error("Neysla: The model's configuration must be an object."),!1;if(e.delimiters&&!(e.delimiters instanceof Array||"string"==typeof e.delimiters||"number"==typeof e.delimiters))return console.error("Neysla: The model's delimiters are not properly defined."),!1;if(!e.delimiters||e.delimiters instanceof Array?e.delimiters||(e.delimiters=[]):e.delimiters=[e.delimiters],"string"==typeof this.name&&(this.name=[this.name]),this.name.length!==e.delimiters.length&&this.name.length-1!==e.delimiters.length)return console.error("Neysla: Incorrect relation between name and delimiters."),!1;let t="";for(let s in this.name)t+=`${this.name[s]}${e.delimiters[s]?"/"+e.delimiters[s]:""}${parseInt(s,10)===this.name.length-1?this.token?`?${this.token.name}=${this.token.value}`:"":"/"}`;return t}_setParams(e){let t="";if(e instanceof Object){let s=0;Object.keys(e).forEach(r=>{t+=`${0!==s||0===s&&this.token?"&":"?"}${r}=${e[r]}`,s++})}return t}_setBody(e,t){let s=null;if(e instanceof Object)switch(t){case"json":s=JSON.stringify(e);break;case"multipart":s=new FormData,Object.keys(e).forEach(t=>s.append(t,e[t]));break;default:s="",Object.keys(e).forEach(t=>s+=`${""!==s?"&":""}${t}=${e[t]}`)}return s}_handleRequest(e){let t;switch(e){case"json":t="application/json";break;case"multipart":t=null;break;default:t="application/x-www-form-urlencoded"}return t}_executeRequest(e){return new Promise((t,s)=>{const r=this.url+e.paramsRequest,n=new XMLHttpRequest;n.addEventListener("progress",e.progress),n.addEventListener("abort",()=>this._handleResponse(n,t,s,r,!0)),n.addEventListener("error",()=>this._handleResponse(n,t,s,r,!0)),n.addEventListener("load",()=>this._handleResponse(n,t,s,r)),n.responseType=e.responseType&&"string"==typeof e.responseType?e.responseType:"json",n.open(e.method,r,!0),e.requestType&&n.setRequestHeader("Content-Type",e.requestType),n.send(e.body)})}_handleResponse(e,t,s,r,n=!1){const o={headers:{},status:e.status,statusText:e.statusText,getHeader:t=>e.getResponseHeader(t),data:e.response,dataType:e.responseType,url:r};let i=e.getAllResponseHeaders().split("\r\n");for(const e of i)if(""!==e){const t=e.split(":");o.headers[t[0]]=t[1].trim()}e.status>=300||0===e.status||n?s(o):t(o)}get(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params)),e.progress instanceof Function||(e.progress=function(){});const s=this._handleRequest(e.requestType);return this._executeRequest({method:"GET",requestType:s,responseType:e.responseType,paramsRequest:t,progress:e.progress,body:null})}head(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params)),e.progress instanceof Function||(e.progress=function(){});const s=this._handleRequest(e.requestType);return this._executeRequest({method:"HEAD",requestType:s,responseType:e.responseType,paramsRequest:t,progress:e.progress,body:null})}post(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params)),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"POST",requestType:r,responseType:e.responseType,paramsRequest:t,progress:e.progress,body:s})}patch(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params)),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"PATCH",requestType:r,responseType:e.responseType,paramsRequest:t,progress:e.progress,body:s})}put(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params)),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"PUT",requestType:r,responseType:e.responseType,paramsRequest:t,progress:e.progress,body:s})}remove(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params)),e.progress instanceof Function||(e.progress=function(){});const s=this._setBody(e.body,e.requestType),r=this._handleRequest(e.requestType);return this._executeRequest({method:"DELETE",requestType:r,responseType:e.responseType,paramsRequest:t,progress:e.progress,body:s})}}module.exports=class{constructor(){this.config=null}init(e){if(this.config=this._doError(e),!this.config)return!1;const t=this._doService(this.config);return new Promise(e=>e(t))}_doError(e){let t=!0;if(e instanceof Object||e instanceof Array?e instanceof Array&&!e.length&&(console.error("Neysla: Array of initializators is empty."),t=!1):(console.error("Neysla: You must set an Array or an Object to initializate your modelers."),t=!1),!t||e instanceof Array||(e=[e]),t)for(let s in e)e[s].name&&"string"==typeof e[s].name&&""!=typeof e[s].name?e[s].url&&"string"==typeof e[s].url&&""!=typeof e[s].url?e[s].token&&"object"==typeof e[s].token&&!("object"==typeof e[s].token&&e[s].token instanceof Array)&&e[s].token.name&&"string"==typeof e[s].token.name&&""!=typeof e[s].token.name&&e[s].token.value&&"string"==typeof e[s].token.value&&""!=typeof e[s].token.value||(console.warn(`Neysla: Initializator with index ${s} has no properly defined token's name and/or value. Therefore no token will be added to your models`),e[s].token=null):(console.error(`Neysla: Initializator with index ${s} has no properly defined url.`),t=!1):(console.error(`Neysla: Initializator with index ${s} has no properly defined name.`),t=!1);return!!t&&e}_doService(e){const t={};for(const s of e)t[s.name]=this._setBuilder(s);return t}_setBuilder(e){return new t({url:e.url,token:e.token})}}}("undefined"==typeof Neysla?Neysla={}:Neysla);