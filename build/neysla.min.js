!function(e){class t{constructor(e){this.config=e}getToken(){return this.config.token}setModel(e){return e instanceof Array||"string"==typeof e?new s(this.config,e):(console.error("Neysla: The model's name is not properly defined."),!1)}}class s{constructor(e,t){this.token=e.token,this.name=t,this.url=e.url}_setUrl(e){if(e instanceof Object){if(e.delimiters&&!(e.delimiters instanceof Array||"string"==typeof e.delimiters||"number"==typeof e.delimiters))return console.error("Neysla: The model's delimiters are not properly defined."),!1}else e={};if(!e.delimiters||e.delimiters instanceof Array?e.delimiters||(e.delimiters=[]):e.delimiters=[e.delimiters],"string"==typeof this.name&&(this.name=[this.name]),this.name.length!==e.delimiters.length&&this.name.length-1!==e.delimiters.length)return console.error("Neysla: Incorrect relation between name and delimiters."),!1;let t="";for(let s in this.name)t+=`${this.name[s]}${e.delimiters[s]?"/"+e.delimiters[s]:""}${parseInt(s,10)===this.name.length-1?this.token?`?${this.token.name}=${this.token.value}`:"":"/"}`;return t}_setParams(e){let t="";if(e instanceof Object){let s=0;Object.keys(e).forEach(r=>{t+=`${0!==s||0===s&&this.token?"&":"?"}${r}=${e[r]}`,s++})}return t}_setBody(e,t){let s=null;return e instanceof Object&&t?s=JSON.stringify(e):e instanceof Object&&(s="",Object.keys(e).forEach(t=>s+=`${""!==s?"&":""}${t}=${e[t]}`)),s}_handleResponse(e,t,s,r){const n={headers:{},status:e.status,statusText:e.statusText,getHeader:t=>e.getResponseHeader(t),data:e.response,dataType:e.responseType,url:r};let o=e.getAllResponseHeaders().split("\r\n");for(const e of o)if(""!==e){const t=e.split(":");n.headers[t[0]]=t[1].trim()}e.status>=300||0===e.status?s(n):t(n)}_executeRequest(e){return new Promise((t,s)=>{const r=this.url+e.paramsRequest,n=new XMLHttpRequest;n.addEventListener("loadend",()=>this._handleResponse(n,t,s,r)),n.responseType=e.responseType&&"string"==typeof e.responseType?e.responseType:"json",n.open(e.method,r,!0),n.setRequestHeader("Content-Type",e.requestJson?"application/json":"application/x-www-form-urlencoded"),n.send(e.body)})}get(e={}){let t=this._setUrl(e);return!1===t?t:(e.params instanceof Object&&(t+=this._setParams(e.params)),this._executeRequest({method:"GET",requestJson:e.requestJson,responseType:e.responseType,paramsRequest:t,body:null}))}head(e={}){let t=this._setUrl(e);return!1===t?t:(e.params instanceof Object&&(t+=this._setParams(e.params)),this._executeRequest({method:"HEAD",requestJson:e.requestJson,responseType:e.responseType,paramsRequest:t,body:null}))}post(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params));const s=this._setBody(e.body,e.requestJson);return this._executeRequest({method:"POST",requestJson:e.requestJson,responseType:e.responseType,paramsRequest:t,body:s})}patch(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params));const s=this._setBody(e.body,e.requestJson);return this._executeRequest({method:"PATCH",requestJson:e.requestJson,responseType:e.responseType,paramsRequest:t,body:s})}put(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params));const s=this._setBody(e.body,e.requestJson);return this._executeRequest({method:"PUT",requestJson:e.requestJson,responseType:e.responseType,paramsRequest:t,body:s})}remove(e={}){let t=this._setUrl(e);if(!1===t)return t;e.params instanceof Object&&(t+=this._setParams(e.params));const s=this._setBody(e.body,e.requestJson);return this._executeRequest({method:"DELETE",requestJson:e.requestJson,responseType:e.responseType,paramsRequest:t,body:s})}}module.exports=class{constructor(e){this.config=e}init(){if(this.config=this._doError(this.config),!this.config)return!1;const e=this._doService(this.config);return new Promise(t=>t(e))}_doError(e){let t=!0;if(e instanceof Object||e instanceof Array?e instanceof Array&&!e.length&&(console.error("Neysla: Array of initializators is empty."),t=!1):(console.error("Neysla: You must set an Array or an Object to initializate your modelers."),t=!1),!t||e instanceof Array||(e=[e]),t)for(let s in e)e[s].name&&"string"==typeof e[s].name&&""!=typeof e[s].name?e[s].url&&"string"==typeof e[s].url&&""!=typeof e[s].url?e[s].token&&"object"==typeof e[s].token&&!("object"==typeof e[s].token&&e[s].token instanceof Array)&&e[s].token.name&&"string"==typeof e[s].token.name&&""!=typeof e[s].token.name&&e[s].token.value&&"string"==typeof e[s].token.value&&""!=typeof e[s].token.value||(console.warn(`Neysla: Initializator with index ${s} has no properly defined token's name and/or value. Therefore no token will be added to your models`),e[s].token=null):(console.error(`Neysla: Initializator with index ${s} has no properly defined url.`),t=!1):(console.error(`Neysla: Initializator with index ${s} has no properly defined name.`),t=!1);return!!t&&e}_doService(e){const t={};for(const s of e)t[s.name]=this._setBuilder(s);return t}_setBuilder(e){return new t({url:e.url,token:e.token})}}}("undefined"==typeof Neysla?Neysla={}:Neysla);